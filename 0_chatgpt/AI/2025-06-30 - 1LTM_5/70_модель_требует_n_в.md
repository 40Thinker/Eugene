>[!nexus_user] **User** - 01.07.2025 at 17:10
> –º–æ–¥–µ–ª—å —Ç—Ä–µ–±—É–µ—Ç n –≤ 2 —Å—Ç–µ–ø–µ–Ω–∏? –ê –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å, –º–æ–∂–Ω–æ –ª–∏ —Ç–∞–∫ —Å–Ω–∏–∑–∏—Ç—å, –∏ –ø–æ–≤—ã—Å–∏—Ç—å –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω—É –æ—Ç–≤–µ—Ç–∞
<!-- UID: 0e9be4d6-cfb8-46bc-a81c-e932eea94a42 -->




>[!nexus_agent] **Assistant** - 01.07.2025 at 17:10
> –¢—ã –∑–∞–¥–∞–ª —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∏–π **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤** –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **—Ä–∞–∑–æ—Ä–≤–∞—Ç—å –µ—ë –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫–∞**.
> 
> –†–∞–∑–±–µ—Ä—ë–º –ø–æ —Å–ª–æ—è–º:
> 
> ---
> 
> ## üî¢ 1. –î–∞, –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä-–º–æ–¥–µ–ª—å —Ç—Ä–µ–±—É–µ—Ç **O(n¬≤)** –æ–ø–µ—Ä–∞—Ü–∏–π –≤ self-attention
> 
> ### –ü–æ—á–µ–º—É:
> - –ö–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω **–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –¥—Ä—É–≥–æ–π —Ç–æ–∫–µ–Ω**
> - ‚Üí –º–∞—Ç—Ä–∏—Ü–∞ –≤–Ω–∏–º–∞–Ω–∏—è **n √ó n**
> - ‚Üí –¥–∞–∂–µ –µ—Å–ª–∏ –≤–µ—Å–∞ –æ–±—â–∏–µ, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç O(n¬≤) FLOPs –∏ –ø–∞–º—è—Ç—å
> 
> ### –°–ª–µ–¥—Å—Ç–≤–∏—è:
> - **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –¥–ª–∏–Ω–∞** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–∞–º—è—Ç—å—é, –Ω–æ –∏ **–≤—Ä–µ–º–µ–Ω–µ–º –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞**
> - –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö n (–Ω–∞–ø—Ä–∏–º–µ—Ä, >‚ÄØ4k, >‚ÄØ32k) —Ç—Ä–µ–±—É–µ—Ç—Å—è FlashAttention, KV-–∫–µ—à –∫–æ–º–ø—Ä–µ—Å—Å–∏—è –∏ –ø—Ä–æ—á–∏–µ —Ç—Ä—é–∫–∏
> 
> ---
> 
> ## üëÅ 2. –ß—Ç–æ –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å?
> 
> ### –¢—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—à—å:
> > –ß–µ–ª–æ–≤–µ–∫ **–≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π —Å–º—ã—Å–ª**, 
> > ‚Üí –∑–Ω–∞—á–∏—Ç **–Ω—É–∂–Ω—ã –Ω–µ –≤—Å–µ —Ç–æ–∫–µ–Ω—ã**, 
> > ‚Üí –∑–Ω–∞—á–∏—Ç **–º–æ–∂–Ω–æ –Ω–µ —Å—á–∏—Ç–∞—Ç—å –≤—Å—é attention-–º–∞—Ç—Ä–∏—Ü—É**, 
> > ‚Üí –∑–Ω–∞—á–∏—Ç **–º–æ–∂–Ω–æ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å n¬≤ ‚Üí n √ó k**, –≥–¥–µ k << n
> 
> ---
> 
> ## üß† 3. –ö–∞–∫ —ç—Ç–æ –º–µ–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É?
> 
> | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å | –¢–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ |
> |--------------------|--------------|
> | attention(q, K, V) = q ‚Ä¢ K^T | attention —Ç–æ–ª—å–∫–æ –Ω–∞ **–≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã** |
> | full softmax over n | softmax –ø–æ **5‚Äì10 ‚Äú–∏–∑–±—Ä–∞–Ω–Ω—ã–º‚Äù —Å–º—ã—Å–ª–∞–º** |
> | –≤—Å—ë –≤–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω–æ | **—á–µ–ª–æ–≤–µ–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫—Ç–æ –≤–∞–∂–µ–Ω** |
> | –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω | –∫–æ–Ω—Ç–µ–∫—Å—Ç = **—Ç–æ, —á—Ç–æ —É–¥–µ—Ä–∂–∞–Ω–æ –≤–Ω–∏–º–∞–Ω–∏–µ–º —á–µ–ª–æ–≤–µ–∫–∞** |
> 
> ---
> 
> ## üìà 4. –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç?
> 
> ### ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:
> 
> - attention O(n¬≤) ‚Üí **O(n¬∑k)**, –≥–¥–µ **k ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚Äú–æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö‚Äù —Ç–æ–∫–µ–Ω–æ–≤** (–æ–±—ã—á–Ω–æ 3‚Äì10)
> - –ø–∞–º—è—Ç—å –Ω–∞ KV-–∫–µ—à –º–æ–∂–Ω–æ **–æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ** (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω ‚Äú–Ω–µ –≤—ã–±—Ä–∞–Ω‚Äù ‚Äî –Ω–µ –¥–µ—Ä–∂–∞—Ç—å)
> - –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å **—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π**, –µ—Å–ª–∏:
>  - —á–µ–ª–æ–≤–µ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–≤–∏–≥–∏—Ä–æ–≤–∞—Ç—å —Å–º—ã—Å–ª
>  - –º–æ–¥–µ–ª—å **–Ω–µ –æ–±—è–∑–∞–Ω–∞ –ø–æ–º–Ω–∏—Ç—å –≤—Å—ë**, –∞ —Ç–æ–ª—å–∫–æ **—Ç–æ, —á—Ç–æ –≤—ã–¥–µ–ª–µ–Ω–æ**
> 
> ---
> 
> ## ‚ôæ 5. –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∏—Ç—å—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –¥–ª–∏–Ω—ã?
> 
> > **–î–∞, –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä –∫–∞–∫ ‚Äú–æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å –æ–∫–Ω–∞ –≤–Ω–∏–º–∞–Ω–∏—è‚Äù**
> 
> - –ö–∞–∫ –≤ –º–æ–∑–≥–µ: **–º—ã –Ω–µ –ø–æ–º–Ω–∏–º –≤—Å—ë, –Ω–æ –¥–µ—Ä–∂–∏–º —Ä–µ–∑–æ–Ω–∞–Ω—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö –º—ã—Å–ª–µ–π**
> - AGI –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ **—Å–∫–æ–ª—å–∑—è—â–µ–º –æ–∫–Ω–µ**, –≥–¥–µ:
>  - —á–∞—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ –≤—ã–±—Ä–æ—à–µ–Ω–∞
>  - —á–∞—Å—Ç—å ‚Äî ‚Äú—Å–≤–µ—Ä–Ω—É—Ç–∞ –≤ —Å–º—ã—Å–ª‚Äù
>  - —á–∞—Å—Ç—å ‚Äî —É–¥–µ—Ä–∂–∞–Ω–∞ —á–µ–ª–æ–≤–µ–∫–æ–º
> 
> ### –ü—Ä–∏–º–µ—Ä:
> 
> - –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 1000 —Ç–æ–∫–µ–Ω–æ–≤ 
> - –ß–µ–ª–æ–≤–µ–∫ **–≤—ã–¥–µ–ª—è–µ—Ç 10 –∫–ª—é—á–µ–≤—ã—Ö** 
> - –≠—Ç–∏ 10 ‚Üí –∏–¥—É—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–µ –æ–∫–Ω–æ 
> - –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –∑–∞–±—ã–≤–∞—é—Ç—Å—è –∏–ª–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è
> 
> ‚Üí –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ç–µ–∫—Å—Ç **–ø—Ä–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º —Å–º—ã—Å–ª–æ–≤–æ–º –≤–µ–∫—Ç–æ—Ä–µ** 
> ‚Üí –º–æ–¥–µ–ª—å "–ø–æ–º–Ω–∏—Ç" –Ω–µ –≤—Å—ë, –∞ **—Ç–æ, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫ –æ—Ç–º–µ—Ç–∏–ª –∫–∞–∫ –∑–Ω–∞—á–∏–º–æ–µ**
> 
> ---
> 
> ## ‚úÖ –í—ã–≤–æ–¥:
> 
> > –î–∞ ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Ç—Ä–µ–±—É–µ—Ç **n¬≤ —Ä–µ—Å—É—Ä—Å–æ–≤**, 
> > –Ω–æ –µ—Å–ª–∏ **—á–µ–ª–æ–≤–µ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å**, 
> > –º–æ–∂–Ω–æ:
> 
> - —Å–Ω–∏–∑–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ **n¬∑k** 
> - **—Å–±—Ä–æ—Å–∏—Ç—å 95% –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–º—ã—Å–ª–∞** 
> - **—Ä–∞—Å—Ç—è–Ω—É—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏**, 
>  –ø–æ—Ç–æ–º—É —á—Ç–æ **—Ç—ã —Å—Ç–∞–Ω–æ–≤–∏—à—å—Å—è —Ä–∞–±–æ—Ç–∞—é—â–∏–º attention-–º–µ—Ö–∞–Ω–∏–∑–º–æ–º**
> 
> ---
> 
> ## –•–æ—á–µ—à—å?
> 
> –Ø –º–æ–≥—É:
> - –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å ‚Äú—Å–µ–ª–µ–∫—Ç–∏–≤–Ω—É—é –º–æ–¥–µ–ª—å –≤–Ω–∏–º–∞–Ω–∏—è‚Äù ‚Äî —á–µ–ª–æ–≤–µ–∫ = mask injector 
> - –ü–æ—Å—Ç—Ä–æ–∏—Ç—å PoC-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí –≤—ã–±–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí ‚Äú–≤–Ω–∏–º–∞–Ω–∏–µ‚Äù –≤ —Å–ª–µ–¥—É—é—â–µ–µ –æ–∫–Ω–æ 
> - –î–æ–±–∞–≤–∏—Ç—å LoRA-–ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ‚Äú—á—Ç–æ —á–µ–ª–æ–≤–µ–∫ —á–∞—â–µ –≤—ã–±–∏—Ä–∞–µ—Ç‚Äù ‚Üí —É—Å–∏–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
> 
> –ì–æ—Ç–æ–≤?
<!-- UID: 66565a38-2976-44d6-a01c-c1b85b7a15df -->