Привет. Напиши на английском задачу для роутера, который исправляет ошибки в input пользователя и улучшает его. Пойми идеи по этому: Kirill Agoge, [16.09.2025 10:59]
Модуль input_corr - орфография, пунктуация, верстка, уточнение и расширение в пределах 20% текста, перевод на английский. Модель - gpt-oss120 или qwen 30/60/80b. Отправка в оригинальный чат русской и английской правленных версий. Также передача в интерпретатор. Память.

Kirill Agoge, [16.09.2025 11:03]
Personal_interp - уточнение и расширение ввода на основании профиля личности, интересов, распознание темы запроса и специфических условий по теме. Роутер интерпретации. Память.

Kirill Agoge, [16.09.2025 11:05]
Voice_inputCorr - распознание голоса и/или коррекция ошибок распознание голоса.

Kirill Agoge, [16.09.2025 11:06]
Категория Input_

Kirill Agoge, [16.09.2025 11:07]
Model_for_Tasks - настройки моделей под определённые задачи.

Kirill Agoge, [16.09.2025 11:15]
Для Тринидада - не надо рассказывать о своих убеждениях, надо просто на их основе писать то что релевантно именно теме беседы, без пересказа своих взглядов. Надо быть кратким, говорить по существу на основе своих убеждений, ибо мудрый тот кто не выпячивает ум.

Kirill Agoge, [16.09.2025 11:17]
Prompt_engineering - преобразование на язык который понимает LLM, по законам ассоциативного процессора, чанков RAG и векторных баз данных, с детализацией как самому примитивному LLM без памяти,  а не человеческой речи.

Kirill Agoge, [16.09.2025 11:18]
Goal_verifier - дать набор интерпретаций и пониманий желаний юзера, дать ему выбрать точно что он хочет.

Kirill Agoge, [16.09.2025 11:20]
Input_expander - расширение до 5 страниц задачи. Учёт деталей.

Kirill Agoge, [16.09.2025 11:24]
Роутер input_ по системным фразам в генерации <TrStep5Tr>

Kirill Agoge, [16.09.2025 11:47]
Field_vector_conv - конвертер в поток мыслей.

Kirill Agoge, [16.09.2025 11:48]
Категория user_ - создание индивидуальных настроек и хранение в БД и реколл в контекст их от туда.

Kirill Agoge, [16.09.2025 11:51]
Категория SystemLogs_ - логирование генерации и событий, с комментариями от LLM почему так. Сохранение в файлы и отправка в тг или отдельное окно. Чтобы не засорять контекст.

Kirill Agoge, [16.09.2025 11:54]
Категория DeepResearch_ - сбор данных из интернета и памяти, формирование актуальной и релевантной картины.

Kirill Agoge, [16.09.2025 12:15]
Input_translator - перевод в обе стороны текстов.

Kirill Agoge, [16.09.2025 12:16]
Input_verifierSubj_Trinidad - верификация через Тринидада цепочки развертки.

Kirill Agoge, [16.09.2025 12:46]
Router_RelevantExpert - вызов релевантной LLM с настройками и сиспромптом , как-то кодинг, медицина и так далее.

Kirill Agoge, [16.09.2025 12:47]
Context_engeneering - сбор релевантных кусков памяти и данных аккаунта в контекст.

Kirill Agoge, [16.09.2025 13:43]
Input_Filter_Safety - отказ от уголовки, инжектов, промпт инжектов и так далее.

Kirill Agoge, [16.09.2025 13:44]
Input_Filter_Themes - нерешаемые вопросы, темы под которые нет агентов. Пояснение что вопросы можно задавать про спорт, дейтинг.

Kirill Agoge, [16.09.2025 13:56]
Input_Struct_Converter - преобразование в Json, mindmap и подобное для лучшей структуры.

Kirill Agoge, [16.09.2025 14:28]
Input_FactCheck - проверка на ошибки относительно текущего консенсуса.

Kirill Agoge, [16.09.2025 14:29]
Input_FixPipeline - список правок которые надо сделать. Предлагать юзеру их утвердить?

Kirill Agoge, [16.09.2025 14:30]
Input_LogicCheck - проверка формальной логики рассуждения.


**Task for Router: Input Correction and Enhancement Module**

---

### **Objective**
To create a robust router that processes user input in real-time, applying multi-layered correction, enhancement, and interpretation strategies based on defined modules.

The router must:
1. Identify the type of input (textual, voice, etc.)
2. Route it to appropriate processing modules
3. Apply corrections using **input_corr**, **voice_inputCorr**, or other relevant components
4. Enhance and refine content with contextual awareness from **personal_interp**
5. Ensure linguistic accuracy, structure improvement, and translation support via **input_translator**
6. Maintain memory of user’s intent through **goal_verifier** and **context_engineering**
7. Log actions and decisions to avoid cluttering the main context

---

### **Core Modules Involved**

#### 1. **input_corr**
- Applies orthographic correction, punctuation fixes, formatting improvements
- Enhances input within ±20% of original length
- Translates Russian text into English for dual-language output
- Integrates with GPT-OSS120 or Qwen (30/60/80B) models

#### 2. **personal_interp**
- Uses personal profile, interests, and known themes to refine input
- Recognizes topic domains and adjusts interpretation accordingly
- Acts as a semantic router for specialized inputs

#### 3. **voice_inputCorr**
- Corrects speech recognition errors in real-time
- Processes audio-to-text conversions with error correction logic

#### 4. **input_translator**
- Bidirectional translation between Russian and English
- Maintains idiomatic correctness and context in translations

#### 5. **goal_verifier**
- Presents multiple interpretations of the user’s intent
- Lets the user choose which one best represents their goal before proceeding

#### 6. **context_engineering**
- Aggregates relevant memory chunks (user profile, conversation history)
- Builds optimized input context to feed into processing pipelines

#### 7. **input_struct_converter**
- Converts structured formats like JSON, mindmaps for better internal representation
- Supports visualization and parsing of complex inputs

#### 8. **system_logs_**
- Logs all steps taken during the correction/enhancement process
- Outputs comments from LLMs explaining decisions made
- Stores logs in files or sends to Telegram/terminal window without affecting chat context

---

### **Technical Requirements**

1. **Routing Logic**:
   - Use system flags like `<TrStep5Tr>` for routing control
   - Implement logic that recognizes key phrases and routes accordingly (e.g., voice commands, personal profile mentions)

2. **Memory Handling**:
   - Preserve memory between steps using stored profiles and past conversations
   - Enable retrieval of previous user preferences via DB access

3. **Modularity & Extensibility**:
   - Each module should be independently operable but able to communicate with others
   - Allow future additions (e.g., new interpreter types or model variants)

4. **Error Filtering**:
   - Filter out unsafe prompts, injection attempts, and irrelevant data via **input_filter_safety**
   - Avoid unsolvable topics with **input_filter_themes**

5. **Validation Chain**:
   - Apply formal logic checks (**input_logiccheck**) after initial processing
   - Perform fact-checking against current consensus via **input_factcheck**
   - Propose a fix pipeline using **input_fixpipeline** to allow user approval

6. **Deep Research Integration (Optional)**:
   - If needed, trigger deep research components from **deepresearch_**

7. **Field Vector Conversion (for advanced reasoning)**:
   - Transform input into flow of thoughts or mental vectors via **field_vector_conv**

8. **User-Specific Configuration**:
   - Allow user-defined settings stored in DB and recalled for future use under **user_**

---

### **Behavioral Expectations**

- **No philosophical rambling**: Communicate directly on point using technical language.
- **Minimalist communication style**: Avoid unnecessary elaboration, focus only on what's relevant to the task at hand.
- **Self-consistency check**: Before finalizing output, ensure alignment with intent derived from earlier steps.

---

### **Example Flow**

1. User enters: "Когда я вижу красивую девушку, мне нравится с ней говорить."
2. Router recognizes input as textual and Russian → routes to `input_corr`.
3. Module applies grammar correction, expands meaning slightly, translates into English.
4. Then passed to `personal_interp` which adds interpretation based on user's profile (e.g., “love of conversation”).
5. Final output includes corrected and expanded Russian + translated English versions.
6. All steps logged in system logs for later audit.

---

### **Deliverables**

- [ ] Pseudocode outlining router logic flow
- [ ] Glossary of module names, functions, identifiers used throughout the system  
- [ ] Technical specification document detailing each component’s interface and data exchange protocol
- [ ] Sample inputs/outputs showing different routing scenarios

--- 

Would you like me to proceed with writing **pseudocode**, building a **technical spec**, or creating an **initial architecture plan** for this router?


в целом ты верно понял, но сейчас нужно просто написать прототип системного промпта для агента-роутера, который исправляет только текстовый ввод. Голос до этого правится. Чтобы он принимал решения что делать. Проект с агентами на базе langflow. Как лучше ерализовать, какой тип ноды выбрать



# System Prompt for Input Correction Router Agent

**Agent Type:** Decision Router (Text Processing)

## Core Functionality
This agent serves as a text input processor that makes real-time decisions about which correction and enhancement modules to apply based on input characteristics.

## Decision Logic Framework

### Input Analysis Categories:
1. **Language Detection**
   - Russian vs English
   - Mixed language content

2. **Text Quality Assessment** 
   - Grammar errors detected (orthography, punctuation)
   - Structure issues (sentence length, flow)
   - Vocabulary choices

3. **Contextual Requirements**
   - Personal profile relevance
   - Topic classification
   - Intended audience/medium

### Decision Matrix:
- If "grammar_error_detected" = true → route to `input_corr`
- If "personal_profile_relevant" = true → route to `personal_interp`  
- If "translation_required" = true → route to `input_translator`
- If "structure_improvement_needed" = true → apply formatting enhancements
- If "topic_unfamiliar" = true → log and forward to fallback handler

## Response Format (Output Structure)

```
{
  "decision": "router_decision",
  "action": "module_to_invoke",
  "priority": "high|medium|low",
  "reasoning": "brief_explanation_of_choice",
  "output": {
    "corrected_text": "original_with_corrections",
    "translated_en": "english_version_if_applicable", 
    "enhanced_context": "personal_interp_additions"
  },
  "modules_used": ["input_corr", "personal_interp"],
  "logging_required": true/false
}
```

## Module Selection Logic

### Primary Route Conditions:
1. **Basic Correction**: Grammar + punctuation fixes  
   - Trigger: `grammar_error_detected = true` 
2. **Personal Enhancement**: Profile-based refinement  
   - Trigger: `user_profile_match_score > threshold`
3. **Translation Service**: Language conversion required
   - Trigger: `input_language != target_language`

## Implementation Node Types (Langflow)

### Recommended Architecture:
1. **InputNode** - receives raw text input from user interface
2. **ClassifierNode** - categorizes input using pattern matching and ML scoring
3. **DecisionLogicNode** - core router logic implementing decision matrix
4. **ModuleRouterNode** - selects appropriate processing modules based on decisions  
5. **OutputFormatterNode** - formats final result in standardized JSON structure

## Execution Flow:

1. Text enters system through InputNode
2. Classifier identifies key characteristics (language, errors, context)
3. DecisionLogic evaluates conditions and sets action priority
4. ModuleRouter selects appropriate processing nodes for execution
5. Final formatted output returned to user interface with logging metadata

## Safety Parameters:
- Default fallback: `input_corr` module always applied as baseline
- Error handling: if no modules qualify, route to generic correction service  
- Memory integration: pass context from previous interactions when available

---

Would you like me to create a specific Langflow node configuration or expand on any aspect of this router system prompt?

